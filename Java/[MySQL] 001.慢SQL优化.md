# 慢SQL优化

1. 首先检查查询字段上是否创建索引，是否命中索引；不走索引的情况：
  - 模糊查询 `like` 的条件前有通配符， `project_name LIKE '%江苏%'` ；
  - 索引字段上有函数或经过计算， `DATE(create_time) < '2025-09-22'` ；
  - 查询语句存在隐式类型转换，如 `id = '123'` ，其中 `id` 为 `INT` ，
  - 索引创建得不合理，优化器将放弃索引；
2. 对大表考虑创建分区，一般是按照范围 `range` 或者离散值 `list` 分区，分区比较简单，不影响代码；
3. 多数慢SQL是因为联表查询引起了，所以可以考虑冗余字段，减少大表之间的联表操作；
4. 缓存查询结果；
5. 对于深度分页的情况，考虑使用标记分页而不是 `offset`，这样就可以使用 `where` 条件筛选掉 `offset` 跳过的数据；
6. 对于SQL语句层面，一般情况下优先使用 `inner join` 而不是 `left join` ；有些情况下考虑使用 `union all` 拆分多个查询后合并结果来代替 `or`；
# $JMM$

Java内存模型（Java Memory Model，JMM）是Java虚拟机规范中所定义的一组规则，它用于控制Java程序中各个变量（包括实例变量和静态变量）的访问方式，以及提供一些保证（如原子性、可见性和有序性）。JMM定义了主内存和每个线程的工作内存，并规定了线程对主内存的读写操作必须经过工作内存，从而实现了线程之间的隔离。JMM还定义了各种内存屏障指令，用于确保内存操作的顺序性和原子性。

因为有多级缓存，CPU并不是直接操作内存，而是把内存的数据读到缓存，而内存的读和写操作的时候就会造成不一致。

JVM规范试图定义一种Java内存模型（JMM），来屏蔽掉各种硬件和操作系统的内存访问差异，从而确保Java程序在各种平台下都能达到一致的内存访问效果。

## JMM三大特性

### 1. 可见性

当一个线程修改了共享变量的值，其他线程能够立即看到修改后的值。

JMM规定所有共享变量都存储在主内存中，每个线程还有自己的工作内存，工作内存中存储了该线程使用到的共享变量的副本。线程对共享变量的所有操作都必须在工作内存中进行，而不能直接读写主内存中的变量。不同的线程之间也无法直接访问对方工作内存中的变量，线程间变量值的传递均需要通过主内存来完成。

### 2. 原子性

原子性是指一个操作是不可中断的，即要么全部执行成功，要么全部执行失败。

### 3. 有序性

有序性是指程序执行的顺序按照代码的顺序来执行。但是由于指令重排的存在，实际的执行顺序有可能与代码顺序不一致。

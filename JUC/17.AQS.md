# AQS

AQS，全称是 AbstractQueuedSynchronizer，中文译为抽象队列式同步器。

是用来实现锁或者其他同步器组件的公共基础部分的抽象实现，是重量级基础框架及JUC体系的基石，主要用于解决锁分配给谁的问题。

整体就是一个抽象的FIFO队列来完成资源获取线程的排队工作，并通过一个int类型的成员变量表示持有锁状态。

锁，面向锁的使用者。定义了程序员和锁交互的使用层API，隐藏了实现细节。
同步器，面向锁的实现者。提出统一规范并简化了锁的实现，将其抽象出来屏蔽了同步状态管理、同步队列的管理和维护、阻塞线程排队和通知、唤醒机制等，是一切锁和同步组件实现的公共基础部分。

加锁会导致阻塞，有阻塞就需要排队，实现排队必然需要用到队列。

共享资源被占用，就需要一定的阻塞等待唤醒机制来保证锁分配的公平性和并发性，这个机制主要用的是CLH队列的变体实现的，即将暂时获取不到锁的线程封装成一个节点（Node）并将其加入到队列中，这个队列就是AQS同步队列的抽象表现。通过CAS、自旋以及LockSupport.park()的方式，维护state变量的状态，使并发达到同步的效果。
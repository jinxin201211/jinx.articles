# 读写锁

## ReentrantReadWriteLock

一个线程可以被多个读线程访问，或者被一个写线程访问，但不能同时存在读写线程。

1. 写锁饥饿问题
2. 注意锁降级


| 特 性 | 说 明 |
| ---- | ---- |
| 公平性选择 | 支持非公平（默认）/公平的锁获取方式，取决于吞吐量还是公平性优先 |
| 重进入 | 读线程在获取读锁之后，可以再次获取读锁；而写线程在获取写锁之后，可以再次获取写锁，也可以再次获取读锁 |
| 锁降级 | 遵循获取写锁、获取读锁再释放写锁的次序，写锁能够降级成为读锁 |

## 锁降级

将写入锁降级为读锁

1. 如果同一个线程持有了写锁，在没有释放写锁的情况下，他还可以继续获取读锁；这就是写锁的降级，降级为读锁；
2. 规则惯例，先获取写锁，然后获取读锁，再释放写锁的次序；
3. 如果释放了写锁，那么就完成转换为读锁；

可以降级，不能升级